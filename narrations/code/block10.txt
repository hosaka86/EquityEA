Let's implement the trading statistics system. (long-break) The CalculateHistoricalStats function runs during initialization, (break) processing all closed trades from account history. (long-break) We reset all counters to zero, (break) then determine today's start time for daily profit tracking. (break) We select the entire history and loop through all deals. (long-break) For each deal, (break) we check if it matches our magic number filter. (break) We only process exit deals, (break) which represent closed positions. (break) For each closed trade, (break) we calculate the true net profit, (break) including swap and commission. (long-break) We increment the appropriate counters, (break) winning or losing, (break) and accumulate the profit and loss totals. (break) If the trade closed today, (break) we add it to the daily profit. (break) At the end, (break) we calculate derived metrics like net profit and win rate. (long-break)